---
title: crosstalk test
author: ''
date: '2020-02-24'
slug: crosstalk-test
categories: []
tags:
  - crosstalk
description: ''
draft: true

---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="/rmarkdown-libs/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<script src="/rmarkdown-libs/bootstrap/js/bootstrap.min.js"></script>


<pre class="r"><code>df_main &lt;- structure(list(pair_indicator = c(
  &quot;902021-902071&quot;, &quot;902031-902071&quot;,
  &quot;902031-902091&quot;, &quot;902081-902101&quot;, &quot;902081-902241&quot;, &quot;902101-902241&quot;
), school_1_lat = c(
  48.2149026, 48.2221631, 48.2221631, 48.2205238,
  48.2205238, 48.223532
), school_2_lat = c(
  48.2186668, 48.2186668,
  48.22407, 48.223532, 48.2231059, 48.2231059
), school_1_long = c(
  16.3876769,
  16.3848147, 16.3848147, 16.4049726, 16.4049726, 16.402895
), school_2_long = c(
  16.3853998,
  16.3853998, 16.3847968, 16.402895, 16.4063758, 16.4063758
), distance = c(
  475.2529684845,
  379.0377208616, 203.6641400739, 395.8339316511, 316.9061306841,
  390.1434258679
), diff_factor = c(
  1.96024763767, 2.27963849016,
  2.27354570637, 1.3, 1.57575757576, 1.21212121212
)), class = c(
  &quot;tbl_df&quot;,
  &quot;tbl&quot;, &quot;data.frame&quot;
), row.names = c(NA, -6L))


df_main &lt;- readr::read_csv2(here(&quot;blog_data&quot;, &quot;Vienna_primary_schools&quot;,
                                        &quot;shared_df_main.csv&quot;))</code></pre>
<pre><code>## Using &#39;,&#39; as decimal and &#39;.&#39; as grouping mark. Use read_delim() for more control.</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   pair_indicator = col_character(),
##   address1 = col_character(),
##   address2 = col_character(),
##   school_1_erhalter = col_character(),
##   school_2_erhalter = col_character(),
##   school_erhalter_indicator = col_character(),
##   erhalter_type = col_character(),
##   tooltip = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<pre class="r"><code>shared_df_main &lt;- SharedData$new(df_main)


# &gt; scatter plotly --------------------------------------------------------
library(plotly)

plot_distance_diff &lt;-  
  plot_ly(
    data=shared_df_main,
    mode=&#39;markers&#39;,
    type=&quot;scatter&quot;
    ) %&gt;% 
  add_trace(
    #text=~tooltip,
    marker=list(color=&#39;green&#39;),
    x=~distance,
    y=~diff_factor,
    showlegend=F
  )
    

# &gt; map -------------------------------------------------------------------

Sys.setenv(&#39;MAPBOX_TOKEN&#39; = &#39;pk.eyJ1Ijoiem9vd2FsayIsImEiOiJjazFjMW52NWIwZDVjM21scmE1Y296MnUxIn0.ZXSu71B2VjyBwlUldNUtLg&#39;)

library(plotly)

cross_map2 &lt;- plot_mapbox(
  data=shared_df_main) %&gt;%
  add_markers(
    y = ~school_1_lat,
    x = ~school_1_long,
    color = &quot;#FF0000&quot;
    #text = ~address1
    ) %&gt;%
  add_markers(
    y = ~school_2_lat,
    x = ~school_2_long,
    color = &quot;#FF0000&quot;
    #text = ~address2
   ) %&gt;%
  layout(
    mapbox = list(style = &#39;light&#39;,
                  zoom = 10,
                  center = list(lat = 48.21, 
                                lon = 16.3720798)
                  ),
    showlegend=FALSE#,
    #margin=0
    )


 
# &gt; combine graphs -----------------------------------------------------------

crosstalk::bscols(
    plot_distance_diff, 
  cross_map2)</code></pre>
<pre><code>## Warning in RColorBrewer::brewer.pal(N, &quot;Set2&quot;): minimal value for n is 3, returning requested palette with 3 different levels

## Warning in RColorBrewer::brewer.pal(N, &quot;Set2&quot;): minimal value for n is 3, returning requested palette with 3 different levels</code></pre>
<div class="container-fluid crosstalk-bscols">
<div class="fluid-row">
<div class="col-xs-6">
<div id="htmlwidget-1" style="width:100%;height:400px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"2dfc1ffa2105":["function () ","plotlyVisDat"]},"cur_data":"2dfc1ffa2105","attrs":{"2dfc1ffa2105":{"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"2dfc1ffa2105.1":{"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","marker":{"color":"green"},"x":{},"y":{},"showlegend":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"distance"},"yaxis":{"domain":[0,1],"automargin":true,"title":"diff_factor"},"dragmode":"zoom","hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"mode":"markers","type":"scatter","key":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36"],"set":"SharedData85b0dcb7","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","_isNestedKey":false,"frame":null},{"mode":"markers","type":"scatter","marker":{"color":"green","line":{"color":"rgba(255,127,14,1)"}},"x":[475.2529684845,379.0377208616,203.6641400739,395.8339316511,316.9061306841,390.1434258679,475.185883338,224.5450544223,383.2521860638,338.6337580877,413.613643906,472.6707021724,33.6244850685,428.9579503191,406.901545442,479.0079035141,110.1659045983,58.9477262586,386.7808433863,429.3383938861,32.6058883861,83.7561751393,136.8682169013,425.0480493771,289.0816726427,113.8003772492,40.9660553196,288.2045206561,207.5722910784,11.702643334,361.5323736887,191.9282886228,427.1708100373,173.1913223808,481.722955727,444.9855379949],"y":[1.96024763767,2.27963849016,2.27354570637,1.3,1.57575757576,1.21212121212,1.52153846154,1.60522273425,1.92938596491,1.99923780488,1.32958801498,1.02813852814,2.56032388664,3.06593406593,1.1974789916,1.31641791045,1.09060846561,2.25420560748,1.43289689034,1.21091581869,1.17584745763,1.36718124643,2.85490196078,1.1490872211,2.79176201373,1.5652173913,2.091796875,1.50116550117,1.25,1.21887824897,1.3465643138,1.5860058309,2.14253563391,1.02063983488,2.18675721562,1.77404718693],"showlegend":false,"key":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36"],"set":"SharedData85b0dcb7","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","_isNestedKey":false,"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0,"ctGroups":["SharedData85b0dcb7"]},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="col-xs-6">
<div id="htmlwidget-2" style="width:100%;height:400px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"visdat":{"2dfc7eaf7a4d":["function () ","plotlyVisDat"]},"cur_data":"2dfc7eaf7a4d","attrs":{"2dfc7eaf7a4d":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"markers","color":"#FF0000","inherit":true},"2dfc7eaf7a4d.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"markers","color":"#FF0000","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"mapType":"mapbox","mapbox":{"domain":{"x":[0,1],"y":[0,1]},"style":"light","zoom":10,"center":{"lat":48.21,"lon":16.3720798}},"showlegend":false,"dragmode":"zoom","hovermode":"closest"},"source":"A","config":{"showSendToCloud":false,"mapboxAccessToken":"pk.eyJ1Ijoiem9vd2FsayIsImEiOiJjazFjMW52NWIwZDVjM21scmE1Y296MnUxIn0.ZXSu71B2VjyBwlUldNUtLg"},"data":[{"type":"scattermapbox","mode":"markers","key":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36"],"set":"SharedData85b0dcb7","name":"#FF0000","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"subplot":"mapbox","lat":[48.2149026,48.2221631,48.2221631,48.2205238,48.2205238,48.223532,48.1938769,48.1938325,48.2060087,48.2102456,48.2258971,48.1666612,48.1761649,48.1761649,48.1761399,48.1689846,48.1546357,48.1780946,48.1965593,48.1945831,48.1990841,48.2074481,48.2196519,48.2087137,48.2177349,48.2407738,48.2406688,48.2758621,48.2711543,48.2520373,48.2172761,48.2280104,48.1526774,48.1526774,48.1504058,48.151477],"lon":[16.3876769,16.3848147,16.3848147,16.4049726,16.4049726,16.402895,16.3929552,16.3997936,16.3416643,16.35204,16.354043,16.3785459,16.3719833,16.3719833,16.3722844,16.3821598,16.4609302,16.3401775,16.33021,16.3331213,16.3349525,16.3213379,16.3109699,16.3080643,16.3315636,16.3820056,16.3675491,16.4109577,16.444838,16.4012157,16.48366,16.4199847,16.3155096,16.3155096,16.3186675,16.314464],"_isNestedKey":false,"frame":null},{"type":"scattermapbox","mode":"markers","key":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36"],"set":"SharedData85b0dcb7","name":"#FF0000","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"subplot":"mapbox","lat":[48.2186668,48.2186668,48.22407,48.223532,48.2231059,48.2231059,48.1913026,48.1919646,48.2095209,48.2079047,48.2275974,48.1689846,48.1761399,48.1788904,48.1788904,48.1649415,48.1552387,48.178591,48.1945831,48.1905807,48.1989212,48.2082286,48.2192381,48.2126744,48.2189602,48.2411642,48.2405285,48.2769341,48.2701705,48.252128,48.2177489,48.2265628,48.1504058,48.151477,48.151477,48.1481636],"lon":[16.3853998,16.3853998,16.3847968,16.402895,16.4063758,16.4063758,16.3894735,16.3988674,16.3409615,16.3499886,16.3573812,16.3821598,16.3722844,16.3748136,16.3748136,16.3840225,16.4617333,16.3399462,16.3331213,16.3334716,16.3352002,16.321267,16.3098063,16.3077052,16.333879,16.3829568,16.3678916,16.4085817,16.4432297,16.4011567,16.4804441,16.4189627,16.3186675,16.314464,16.314464,16.3120419],"_isNestedKey":false,"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0,"ctGroups":["SharedData85b0dcb7"]},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<pre class="r"><code>library(htmltools)
browsable(tagList(plot_distance_diff, cross_map2))</code></pre>
<pre><code>## Warning in RColorBrewer::brewer.pal(N, &quot;Set2&quot;): minimal value for n is 3, returning requested palette with 3 different levels

## Warning in RColorBrewer::brewer.pal(N, &quot;Set2&quot;): minimal value for n is 3, returning requested palette with 3 different levels</code></pre>
<div id="htmlwidget-3" style="width:100%;height:400px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"visdat":{"2dfc1ffa2105":["function () ","plotlyVisDat"]},"cur_data":"2dfc1ffa2105","attrs":{"2dfc1ffa2105":{"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"2dfc1ffa2105.1":{"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","marker":{"color":"green"},"x":{},"y":{},"showlegend":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"distance"},"yaxis":{"domain":[0,1],"automargin":true,"title":"diff_factor"},"dragmode":"zoom","hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"mode":"markers","type":"scatter","key":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36"],"set":"SharedData85b0dcb7","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","_isNestedKey":false,"frame":null},{"mode":"markers","type":"scatter","marker":{"color":"green","line":{"color":"rgba(255,127,14,1)"}},"x":[475.2529684845,379.0377208616,203.6641400739,395.8339316511,316.9061306841,390.1434258679,475.185883338,224.5450544223,383.2521860638,338.6337580877,413.613643906,472.6707021724,33.6244850685,428.9579503191,406.901545442,479.0079035141,110.1659045983,58.9477262586,386.7808433863,429.3383938861,32.6058883861,83.7561751393,136.8682169013,425.0480493771,289.0816726427,113.8003772492,40.9660553196,288.2045206561,207.5722910784,11.702643334,361.5323736887,191.9282886228,427.1708100373,173.1913223808,481.722955727,444.9855379949],"y":[1.96024763767,2.27963849016,2.27354570637,1.3,1.57575757576,1.21212121212,1.52153846154,1.60522273425,1.92938596491,1.99923780488,1.32958801498,1.02813852814,2.56032388664,3.06593406593,1.1974789916,1.31641791045,1.09060846561,2.25420560748,1.43289689034,1.21091581869,1.17584745763,1.36718124643,2.85490196078,1.1490872211,2.79176201373,1.5652173913,2.091796875,1.50116550117,1.25,1.21887824897,1.3465643138,1.5860058309,2.14253563391,1.02063983488,2.18675721562,1.77404718693],"showlegend":false,"key":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36"],"set":"SharedData85b0dcb7","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","_isNestedKey":false,"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0,"ctGroups":["SharedData85b0dcb7"]},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div id="htmlwidget-4" style="width:100%;height:400px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4">{"x":{"visdat":{"2dfc7eaf7a4d":["function () ","plotlyVisDat"]},"cur_data":"2dfc7eaf7a4d","attrs":{"2dfc7eaf7a4d":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"markers","color":"#FF0000","inherit":true},"2dfc7eaf7a4d.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"markers","color":"#FF0000","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"mapType":"mapbox","mapbox":{"domain":{"x":[0,1],"y":[0,1]},"style":"light","zoom":10,"center":{"lat":48.21,"lon":16.3720798}},"showlegend":false,"dragmode":"zoom","hovermode":"closest"},"source":"A","config":{"showSendToCloud":false,"mapboxAccessToken":"pk.eyJ1Ijoiem9vd2FsayIsImEiOiJjazFjMW52NWIwZDVjM21scmE1Y296MnUxIn0.ZXSu71B2VjyBwlUldNUtLg"},"data":[{"type":"scattermapbox","mode":"markers","key":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36"],"set":"SharedData85b0dcb7","name":"#FF0000","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"subplot":"mapbox","lat":[48.2149026,48.2221631,48.2221631,48.2205238,48.2205238,48.223532,48.1938769,48.1938325,48.2060087,48.2102456,48.2258971,48.1666612,48.1761649,48.1761649,48.1761399,48.1689846,48.1546357,48.1780946,48.1965593,48.1945831,48.1990841,48.2074481,48.2196519,48.2087137,48.2177349,48.2407738,48.2406688,48.2758621,48.2711543,48.2520373,48.2172761,48.2280104,48.1526774,48.1526774,48.1504058,48.151477],"lon":[16.3876769,16.3848147,16.3848147,16.4049726,16.4049726,16.402895,16.3929552,16.3997936,16.3416643,16.35204,16.354043,16.3785459,16.3719833,16.3719833,16.3722844,16.3821598,16.4609302,16.3401775,16.33021,16.3331213,16.3349525,16.3213379,16.3109699,16.3080643,16.3315636,16.3820056,16.3675491,16.4109577,16.444838,16.4012157,16.48366,16.4199847,16.3155096,16.3155096,16.3186675,16.314464],"_isNestedKey":false,"frame":null},{"type":"scattermapbox","mode":"markers","key":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36"],"set":"SharedData85b0dcb7","name":"#FF0000","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"subplot":"mapbox","lat":[48.2186668,48.2186668,48.22407,48.223532,48.2231059,48.2231059,48.1913026,48.1919646,48.2095209,48.2079047,48.2275974,48.1689846,48.1761399,48.1788904,48.1788904,48.1649415,48.1552387,48.178591,48.1945831,48.1905807,48.1989212,48.2082286,48.2192381,48.2126744,48.2189602,48.2411642,48.2405285,48.2769341,48.2701705,48.252128,48.2177489,48.2265628,48.1504058,48.151477,48.151477,48.1481636],"lon":[16.3853998,16.3853998,16.3847968,16.402895,16.4063758,16.4063758,16.3894735,16.3988674,16.3409615,16.3499886,16.3573812,16.3821598,16.3722844,16.3748136,16.3748136,16.3840225,16.4617333,16.3399462,16.3331213,16.3334716,16.3352002,16.321267,16.3098063,16.3077052,16.333879,16.3829568,16.3678916,16.4085817,16.4432297,16.4011567,16.4804441,16.4189627,16.3186675,16.314464,16.314464,16.3120419],"_isNestedKey":false,"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0,"ctGroups":["SharedData85b0dcb7"]},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
