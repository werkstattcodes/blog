---
title: Potential sizing issue when importing interactive plots (ggraph; htmlWidget)
author: rs
date: '2019-11-12'
slug: size-interactive-plots
categories: []
draft: true
tags:
  - ggiraph
description: ''
output: html_document
---

This post documents a potential issue when it comes to sizing interactive images/htmlwidgets produced with the `ggiraph` and `htmlwidgets` packages. The goal is to import interactive graphs produced in other R(Studio) Projects into a `blogdown` post. I assume/hope there there is a relatively easy solution to it, but I haven't yet figured it out.


# Create interactive plot
First, let's create an interactive plot. Here it has the dimensions 10 by 5 inches and is meant to have no padding. The result is as expected. The goal is to have a similar appearance/behavior after importing this graph into a blogdown post in a different R project. The vertical and horizontal page re-size nicely, text flow remains in order.

```{r remedy001}
library(tidyverse)
library(htmlwidgets)
library(ggiraph)

my_plot <- mtcars %>% 
  rownames_to_column(., var="car_name") %>% 
  ggplot()+
  geom_point_interactive(aes(x=mpg,
                             y=drat,
                             tooltip=car_name,
                             data_id=car_name))
  


my_plot <- girafe(code = print(my_plot), 
                  width_svg=10,
                  height_svg= 5,
                  options = list(opts_toolbar(saveaspng = FALSE),
                                 opts_sizing(rescale=T),
                                 opts_tooltip(css="background-color:lightgray;"))) %>%
  girafe_options(.,
                 sizingPolicy(padding = "0px"))

my_plot

```


# Export plot as htmlwidget

Now, let's save this interactive plot with the `saveWidget` function from the `htmlwidgets` package. The purpose is to import the interactive plot into a `blogdown` post (as below). To highlight/make visible the remaining padding, I set the background to red.


```{r, eval=F}
saveWidget(my_plot, file="widget_saved_wo_padding_with_rescaling.html",
            background = "red")

```
# Import widget as an iframe

## with dimensions defined in absolute terms
10 x 5 inches = 960 x 480 pxls  
*advantage*: vertical space after plot remains fixed; text flow does not get distorted  
*disadvantage*: iframe/graph does not shrink horizontally; graph reaches into table of contents on the right side when changing size of browser/screen

```{r, eval=F}


<iframe id="inlineFrameExample2"

    title="Inline Frame Example2"

    width="960"

    height="480"

    frameborder="0" scrolling="no" 


    src="/post/2019-11-12-size-issue-ggraph_files/widget_saved_wo_padding_with_rescaling.html">

</iframe>

```

<iframe id="inlineFrameExample2"

    title="Inline Frame Example2"

    width="960"

    height="480"

    frameborder="0" scrolling="no" 


    src="/post/2019-11-12-size-issue-ggraph_files/widget_saved_wo_padding_with_rescaling.html">

</iframe>
text under plot; is there excessive space?


## relative definition of dimensions
*disadvantage*: vertical space too small; graph is cut off;


```{r, eval=F}

<iframe id="inlineFrameExample3"

    title="Inline Frame Example3"

    frameborder="0" scrolling="no" 

    style="position: relative; height: 100%; width: 100%;"

    src="/post/2019-11-12-size-issue-ggraph_files/widget_saved_w_padding_with_rescaling.html">

</iframe>

```


<iframe id="inlineFrameExample3"

    title="Inline Frame Example3"

    frameborder="0" scrolling="no" 

    style="position: relative; width: 100%; height: 100%"

    src="/post/2019-11-12-size-issue-ggraph_files/widget_saved_w_padding_with_rescaling.html">

</iframe>
text under plot; is there excessive space?



## mixing relative and absolute definition of dimensions
*disadvantage*: excessive vertical space reemerges when moving to smaller screen

```{r, eval=F}

<iframe id="inlineFrameExample4"

    title="Inline Frame Example3"

    frameborder="0" scrolling="no" 

    style="position: relative; height:480px; width: 100%;"

    src="/post/2019-11-12-size-issue-ggraph_files/widget_saved_w_padding_with_rescaling.html">

</iframe>

```


<iframe id="inlineFrameExample3"

    title="Inline Frame Example3"

    frameborder="0" scrolling="no" 

    style="position: relative; height:480px; width: 100%;"

    src="/post/2019-11-12-size-issue-ggraph_files/widget_saved_w_padding_with_rescaling.html">

</iframe>
text under text under plot; is there excessive space?


# Javascript (digging a hole...)

resizes the plot when reloading the browser; should be a reising trigger though...

<iframe src="/post/2019-11-12-size-issue-ggraph_files/widget_saved_w_padding_with_rescaling.html" onload='javascript:(function(o){o.style.height=o.contentWindow.document.body.scrollHeight+"px";}(this));' style="height:480px;width:100%;border:none;overflow:hidden;"></iframe>
text under plot; is there excessive space?



<br/><br/>
<br/><br/>


# OLD: Import widget and adjust sizing

Now let's import the widget into the a `blogdown` blogpost (via the insert image function of the blogdown add-in). Several seizing versions are demonstrated below:

## without size options  
Without any sizing options the plot is small and embedded with a vertical scrollbar. Note that there is a small 
padding at the bottom (in red).

```{r, eval=F}
![](/post/2019-11-12-size-issue-ggraph_files/widget_saved_wo_padding.html)
```

![](/post/2019-11-12-size-issue-ggraph_files/widget_saved_wo_padding.html)

## width=100% height=100%  
The plot as an intended size, but the height is still too small (despite height=100%).

```{r, eval=F}
![](/post/2019-11-12-size-issue-ggraph_files/widget_saved_wo_padding.html){width=100% height=100%}

```

![](/post/2019-11-12-size-issue-ggraph_files/widget_saved_wo_padding.html){width=100% height=100%}

## width=100% height=672px
The vertical size of the plot changes but remains too small; vertical scrollbars remain

```{r, eval=F}
![](/post/2019-11-12-size-issue-ggraph_files/widget_saved_wo_padding.html){width=100% height=672px}

```

![](/post/2019-11-12-size-issue-ggraph_files/widget_saved_wo_padding.html){width=100% height=672px}


## width=100% height=1100px 
The plot is now well visible, without any scrollbars. The padding at the bottom grew somewhat but is sitll ok.

```{r, eval=F}

![](/post/2019-11-12-size-issue-ggraph_files/widget_saved_wo_padding.html){width=100% height=1100px}


```

![](/post/2019-11-12-size-issue-ggraph_files/widget_saved_wo_padding.html){width=100% height=1100px}

## PROBLEM: Laptopscreen; padding becomes too large
When moving the browser window from my main screen to the laptop screen, the padding grows and becomes distorting (I assume others can replicate this). The reason is likely that the laptop screen has fewer pixles and the 'fix' definition of the vertical size (1100 px) appears proportionally larger. How to solve this?

![](/post/2019-11-12-size-issue-ggraph_files/screen_shot_laptop.PNG)


## rescale=F

```{r, eval=F}

my_plot <- girafe(code = print(my_plot), 
                  width_svg=10,
                  height_svg= 7,
                  options = list(opts_toolbar(saveaspng = FALSE),
                                 opts_sizing(rescale=F),
                                 opts_tooltip(css="background-color:lightgray;")))

![](/post/2019-11-12-size-issue-ggraph_files/widget_saved_wo_padding_no_rescaling.html){width=100% height=100%}

```


![](/post/2019-11-12-size-issue-ggraph_files/widget_saved_wo_padding_no_rescaling.html){width=100% height=100%}



##without padding=0

![](/post/2019-11-12-size-issue-ggraph_files/widget_saved_w_padding_with_rescaling.html)



```{r, eval=F}
# Attempt with plotly

library(plotly)
my_plot_2 <- mtcars %>% 
  rownames_to_column(., var="car_name") %>% 
  ggplot()+
  geom_point(aes(x=mpg,
                 y=drat))
  
plotly::ggplotly(my_plot_2)
my_plotly <- plotly::ggplotly(my_plot_2)
htmlwidgets::saveWidget(as_widget(my_plotly), paste0(wdr, "plotly_graph.html"))

```

![](/post/2019-11-12-size-issue-ggraph_files/plotly_graph.html){width=100% height=100%}